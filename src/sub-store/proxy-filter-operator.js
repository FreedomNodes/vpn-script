/*
 fullhash:164ad9a81da617ed8b41, chunkhash:c3c7c43048ae8b3b9795, file:sub-store/proxy-filter-operator.js
 author: Kien Tran
 */
(()=>{(()=>{"use strict";var R={3183:(f,c,r)=>{var _;typeof window!="undefined"?_=window:typeof r.g!="undefined"?_=r.g:typeof self!="undefined"?_=self:_={},f.exports=_},8475:(f,c,r)=>{r.d(c,{A:()=>h});const _=$substore;class i{constructor(t,u){this.key=t,this.expires=u;const s=_.read(t);s?this.resourceCache=JSON.parse(s):(this.resourceCache={},this._persist()),this._cleanup()}_cleanup(){let t=!1;const u=new Date().getTime();Object.keys(this.resourceCache).forEach(s=>{const y=this.resourceCache[s];(!y.time||u-y.time>this.expires)&&(delete this.resourceCache[s],_.delete(`#${s}`),t=!0)}),t&&this._persist()}revokeIds(t){let u=!1;for(const s of t)delete this.resourceCache[s],u=!0;u&&this._persist()}revokeAll(){this.resourceCache={},this._persist()}_persist(){_.write(JSON.stringify(this.resourceCache),this.key)}get(t){const u=this.resourceCache[t]&&this.resourceCache[t].time;return u&&new Date().getTime()-u<=this.expires?this.resourceCache[t].data:null}set(t,u){this.resourceCache[t]={time:new Date().getTime(),data:u},this._persist()}}const h=i},423:(f,c,r)=>{r.d(c,{ru:()=>i});var _=(t,u,s)=>new Promise((y,O)=>{var I=g=>{try{S(s.next(g))}catch(T){O(T)}},A=g=>{try{S(s.throw(g))}catch(T){O(T)}},S=g=>g.done?y(g.value):Promise.resolve(g.value).then(I,A);S((s=s.apply(t,u)).next())});function i(){return _(this,null,function*(){const t=yield produceArtifact({type:"file",name:"proxy_config"});return ProxyUtils.yaml.safeLoad(t)})}function h(){return _(this,null,function*(){const t=yield produceArtifact({type:"file",name:"subscription_config"});return ProxyUtils.yaml.safeLoad(t)})}function P(t){return _(this,null,function*(){const u=normalizeString(t),s=yield h();let y="";for(const O in s)if(containsIgnoreCase(u,normalizeString(O))){y=O;break}return s[y]})}},1500:(f,c,r)=>{r.d(c,{Dq:()=>P,Mi:()=>y,S9:()=>I,Vo:()=>s,l0:()=>t,qu:()=>u,u6:()=>S});var _=Math.pow,i=(d,E,l)=>new Promise((m,p)=>{var w=n=>{try{o(l.next(n))}catch(a){p(a)}},e=n=>{try{o(l.throw(n))}catch(a){p(a)}},o=n=>n.done?m(n.value):Promise.resolve(n.value).then(w,e);o((l=l.apply(d,E)).next())});const h=$substore,P={viettel:["Viettel Group","VIETTEL","AS7552 Viettel Group","VIETEL-AS-AP"],vnpt:["Vietnam Posts and Telecommunications Group","VNPT","AS135905 VIETNAM POSTS AND TELECOMMUNICATIONS GROUP","VNPT-AS-VN"],mobifone:["MOBIFONE","Mobifone Corporation","AS131429 MOBIFONE Corporation","MOBIFONE-AS-VN"],fpt:["FPT Telecom Company","AS18403 FPT Telecom Company","FPT-AS-AP"],google:["Google LLC","Google Cloud","AS15169 Google LLC"],mcloud:["MCLOUD","1mcloud Technology Company Limited","S149078 VPSMMO TECHNOLOGY COMPANY LIMITED","VPSMMO-AS-VN"],gnetwork:["GNETWORK","Gnetwork Company Limited","AS63737 VIETSERVER SERVICES TECHNOLOGY COMPANY LIMITED","VIETSERVER-AS-VN"],akamai:["Akamai Technologies","Linode","AS63949 Akamai Connected Cloud","AKAMAI-LINODE-AP"],cloviet:["CLOVIET","Cloud Viet ONE Member Company Limited","AS135918 VIET DIGITAL TECHNOLOGY LIABILITY COMPANY","DVS-AS-VN"],vietDigital:["Viet Digital Technology Liability Company","Mailand Technology Trading Services Company Limited","AS135918 VIET DIGITAL TECHNOLOGY LIABILITY COMPANY","DVS-AS-VN"],vietServer:["Vietserver Services Technology Company Limited","T-media Digital Technology Company Limited","AS63737 VIETSERVER SERVICES TECHNOLOGY COMPANY LIMITED","VIETSERVER-AS-VN"],digitalOcean:["DigitalOcean, LLC","AS14061 DigitalOcean, LLC","DIGITALOCEAN-ASN"],cloudfly:["Cloudfly Corporation","AS149089 CLOUDFLY CORPORATION","CLOUDFLY-VN"]};function t(d){return!!/^[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,6}$/i.test(d)}function u(d){return!!/^(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]?|0)\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]?|0)\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]?|0)\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]?|0)(\/([1-9]|[1-2][0-9]|3[0-2])){0,1}$/.test(d)}function s(d,E){const l=d.split("."),m=E.split(".");if(l.length<3||m.length<3)return!1;for(let p=0;p<3;p++)if(l[p]!==m[p])return!1;return!0}function y(d){const E=d.split(".");return E[E.length-1]}function O(d){return i(this,null,function*(){const E=`https://cloudflare-dns.com/dns-query?name=${encodeURIComponent(d)}&type=A`,l={Accept:"application/dns-json"};try{const m=yield h.http.get({url:E,headers:l}),p=JSON.parse(m.body);if(p.Status!==0)throw new Error(`HTTP error! status: ${p.Status}`);return p.Answer?p.Answer.map(w=>`${w.data}`)[0]:""}catch(m){return""}})}function I(d){return i(this,null,function*(){return yield h.http.get(`https://dns.google/resolve?name=${d}`).then(l=>{const m=JSON.parse(l.body);if(m.Status===0){const p=m.Answer.find(w=>w.type===1);return p?p.data:""}return""})})}function A(d){return i(this,null,function*(){return yield h.http.get(`http://ip-api.com/json/${d}?fields=country`).then(l=>JSON.parse(l.body).country||"")})}function S(d){return i(this,null,function*(){return yield h.http.get(`http://ip-api.com/json/${d}?fields=isp`).then(l=>JSON.parse(l.body).isp||"")})}function g(d){return i(this,null,function*(){return yield h.http.post({url:"http://ip-api.com/batch?fields=isp",body:JSON.stringify(d)}).then(l=>JSON.parse(l.body).map(p=>p.isp))})}function T(d,E){let l,m;const p=D(d);if((l=E.match(/^(.*?)\/(\d{1,2})$/))&&(m=D(l[1]))>=0){const w=_(2,32-parseInt(l[2]));return p>=m&&p<=m+w-1}return!1}function D(d){let E;if(E=d.match(/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/)){let l=0,m=1;for(let p=4;p>=1;p-=1)l+=m*parseInt(E[p]),m*=256;return l}return-1}},9085:(f,c,r)=>{r.d(c,{G:()=>_});function _(h){return h&&h!=="null"&&h!=="undefined"}function i(h,P){return h.reduce((t,u)=>{const s=u[P];return t[s]||(t[s]=[]),t[s].push(u),t},{})}},4173:(f,c,r)=>{r.d(c,{Ck:()=>g,Hd:()=>D,eD:()=>T,um:()=>d,xG:()=>S});var _=r(1058),i=r(1500),h=r(8475),P=Math.pow,t=(e,o,n)=>new Promise((a,C)=>{var N=L=>{try{M(n.next(L))}catch(V){C(V)}},k=L=>{try{M(n.throw(L))}catch(V){C(V)}},M=L=>L.done?a(L.value):Promise.resolve(L.value).then(N,k);M((n=n.apply(e,o)).next())});const u="#sub-store-cached-dns",s="#sub-store-cached-isp",y=7*24*60*60*1e3,O=new h.A(u,y),I=new h.A(s,y);function A(e,o){e.type==="vmess"&&e.network==="ws"&&(e["ws-opts"]=e["ws-opts"]||{},e["ws-opts"].headers=e["ws-opts"].headers||{},e["ws-opts"].headers.Host=o),e.sni=o,isRealValue(e["skip-cert-verify"])||(e["skip-cert-verify"]=!0)}const S=(e,o)=>(0,_.A)(e.regex).test(o.name),g=(e,o)=>e.ports.some(n=>n===o.port),T=(e,o)=>t(void 0,null,function*(){return(yield Promise.all(e.ips.map(a=>m(o.server,a)))).some(a=>a)}),D=(e,o)=>t(void 0,null,function*(){return(yield Promise.all(e.isps.map(a=>E(o.server,a)))).some(a=>a)});function d(e,o,n){return t(this,null,function*(){return(yield Promise.all(e.map(C=>C(o,n)))).every(C=>C)})}function E(e,o){return t(this,null,function*(){let n=e;if((0,i.l0)(e)){const a=O.get(e);if(a)n=a;else{const C=yield(0,i.S9)(e);n=C,C&&O.set(e,C)}}return l(n,o)})}function l(e,o){return t(this,null,function*(){let n="";const a=I.get(e);return a?n=a:(n=yield(0,i.u6)(e),n&&I.set(e,n)),!!i.Dq[o].some(N=>RegExp(`${N}`,"i").test(n))})}function m(e,o){return t(this,null,function*(){let n=e;if((0,i.l0)(e)){const a=O.get(e);if(a)n=a;else{const C=yield(0,i.S9)(e);n=C,C&&O.set(e,C)}}return p(n,o)})}function p(e,o){if(!(0,i.qu)(e))return!1;if(o.indexOf("/")<0)return!!(e===o||(0,i.Vo)(e,o)&&(0,i.Mi)(o)==="*");let n,a;const C=w(e);if((n=o.match(/^(.*?)\/(\d{1,2})$/))&&(a=w(n[1]))>=0){const N=P(2,32-parseInt(n[2]));return C>=a&&C<=a+N-1}return!1}function w(e){let o;if(o=e.match(/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/)){let n=0,a=1;for(let C=4;C>=1;C-=1)n+=a*parseInt(o[C]),a*=256;return n}return-1}},1058:(f,c,r)=>{r.d(c,{A:()=>_});function _(i){const h=i.lastIndexOf("/");return new RegExp(i.slice(1,h),i.slice(h+1))}}},b={};function v(f){var c=b[f];if(c!==void 0)return c.exports;var r=b[f]={exports:{}};return R[f](r,r.exports,v),r.exports}v.n=f=>{var c=f&&f.__esModule?()=>f.default:()=>f;return v.d(c,{a:c}),c},v.d=(f,c)=>{for(var r in c)v.o(c,r)&&!v.o(f,r)&&Object.defineProperty(f,r,{enumerable:!0,get:c[r]})},v.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch(f){if(typeof window=="object")return window}}(),v.o=(f,c)=>Object.prototype.hasOwnProperty.call(f,c);var G={};(()=>{var f=v(3183),c=v.n(f),r=v(9085),_=v(423),i=v(4173),h=(t,u,s)=>new Promise((y,O)=>{var I=g=>{try{S(s.next(g))}catch(T){O(T)}},A=g=>{try{S(s.throw(g))}catch(T){O(T)}},S=g=>g.done?y(g.value):Promise.resolve(g.value).then(I,A);S((s=s.apply(t,u)).next())});function P(t){return h(this,null,function*(){const{type:u}=$arguments,s=yield(0,_.ru)(),y=(0,r.G)(u)?s[u]:s[t[0].collectionName];if(!(0,r.G)(y))return t;const O=[];for(const I of t){const A=[];if((0,r.G)(y.regex)&&A.push(i.xG),(0,r.G)(y.ports)&&A.push(i.Ck),(0,r.G)(y.ips)&&A.push(i.eD),(0,r.G)(y.isps)&&A.push(i.Hd),A.length===0){O.push(I);continue}(yield(0,i.um)(A,y,I))&&O.push(I)}return O})}c().operator=P})()})();})();
