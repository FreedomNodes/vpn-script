/*!
 substore-tools - version: 1.2.3
 Build fullhash:084113a448a1c331f0d6, chunkhash:f0936d11a66099c58e04 (2024-05-11 22:22:51)

 Author: Kien Tran
*/
(()=>{(()=>{"use strict";var Y={3183:(_,p,o)=>{var m;typeof window!="undefined"?m=window:typeof o.g!="undefined"?m=o.g:typeof self!="undefined"?m=self:m={},_.exports=m},8475:(_,p,o)=>{o.d(p,{A:()=>s});const m=$substore;class g{constructor(t,i){this.key=t,this.expires=i;const a=m.read(t);a?this.resourceCache=JSON.parse(a):(this.resourceCache={},this._persist()),this._cleanup()}_cleanup(){let t=!1;const i=new Date().getTime();Object.keys(this.resourceCache).forEach(a=>{const v=this.resourceCache[a];(!v.time||i-v.time>this.expires)&&(delete this.resourceCache[a],m.delete(`#${a}`),t=!0)}),t&&this._persist()}revokeIds(t){let i=!1;for(const a of t)delete this.resourceCache[a],i=!0;i&&this._persist()}revokeAll(){this.resourceCache={},this._persist()}_persist(){m.write(JSON.stringify(this.resourceCache),this.key)}get(t){const i=this.resourceCache[t]&&this.resourceCache[t].time;return i&&new Date().getTime()-i<=this.expires?this.resourceCache[t].data:null}set(t,i){this.resourceCache[t]={time:new Date().getTime(),data:i},this._persist()}}const s=g},423:(_,p,o)=>{o.d(p,{ru:()=>g});var m=(t,i,a)=>new Promise((v,I)=>{var S=u=>{try{C(a.next(u))}catch(P){I(P)}},T=u=>{try{C(a.throw(u))}catch(P){I(P)}},C=u=>u.done?v(u.value):Promise.resolve(u.value).then(S,T);C((a=a.apply(t,i)).next())});function g(){return m(this,null,function*(){const t=yield produceArtifact({type:"file",name:"proxy_config"});return ProxyUtils.yaml.safeLoad(t)})}function s(){return m(this,null,function*(){const t=yield produceArtifact({type:"file",name:"subscription_config"});return ProxyUtils.yaml.safeLoad(t)})}function O(t){return m(this,null,function*(){const i=normalizeString(t),a=yield s();let v="";for(const I in a)if(containsIgnoreCase(i,normalizeString(I))){v=I;break}return a[v]})}},1500:(_,p,o)=>{o.d(p,{Dq:()=>O,Mi:()=>I,S9:()=>T,Vo:()=>v,Zg:()=>t,l0:()=>i,qu:()=>a,sY:()=>u,u6:()=>P});var m=Math.pow,g=(d,E,l)=>new Promise((f,h)=>{var w=e=>{try{R(l.next(e))}catch(n){h(n)}},V=e=>{try{R(l.throw(e))}catch(n){h(n)}},R=e=>e.done?f(e.value):Promise.resolve(e.value).then(w,V);R((l=l.apply(d,E)).next())});const s=$substore,O={viettel:["Viettel Group","VIETTEL","AS7552 Viettel Group","VIETEL-AS-AP"],vnpt:["Vietnam Posts and Telecommunications Group","VNPT","AS135905 VIETNAM POSTS AND TELECOMMUNICATIONS GROUP","VNPT-AS-VN"],mobifone:["MOBIFONE","Mobifone Corporation","AS131429 MOBIFONE Corporation","MOBIFONE-AS-VN"],fpt:["FPT Telecom Company","AS18403 FPT Telecom Company","FPT-AS-AP"],google:["Google LLC","Google Cloud","AS15169 Google LLC"],mcloud:["MCLOUD","1mcloud Technology Company Limited","S149078 VPSMMO TECHNOLOGY COMPANY LIMITED","VPSMMO-AS-VN"],gnetwork:["GNETWORK","Gnetwork Company Limited","AS63737 VIETSERVER SERVICES TECHNOLOGY COMPANY LIMITED","VIETSERVER-AS-VN"],akamai:["Akamai Technologies","Linode","AS63949 Akamai Connected Cloud","AKAMAI-LINODE-AP"],cloviet:["CLOVIET","Cloud Viet ONE Member Company Limited","AS135918 VIET DIGITAL TECHNOLOGY LIABILITY COMPANY","DVS-AS-VN"],vietDigital:["Viet Digital Technology Liability Company","Mailand Technology Trading Services Company Limited","AS135918 VIET DIGITAL TECHNOLOGY LIABILITY COMPANY","DVS-AS-VN"],vietServer:["Vietserver Services Technology Company Limited","T-media Digital Technology Company Limited","AS63737 VIETSERVER SERVICES TECHNOLOGY COMPANY LIMITED","VIETSERVER-AS-VN"],digitalOcean:["DigitalOcean, LLC","AS14061 DigitalOcean, LLC","DIGITALOCEAN-ASN"],cloudfly:["Cloudfly Corporation","AS149089 CLOUDFLY CORPORATION","CLOUDFLY-VN"],vpsmmo:["Vpsmmo Technology Company Limited","1mcloud Technology Company Limited","AS149078 VPSMMO TECHNOLOGY COMPANY LIMITED","VPSMMO-AS-VN"]},t={hn:["HN","Hanoi"],dn:["DN","Da Nang"],sg:["SG","Ho Chi Minh"]};function i(d){return!!/^[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,6}$/i.test(d)}function a(d){return!!/^(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]?|0)\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]?|0)\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]?|0)\.(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]?|0)(\/([1-9]|[1-2][0-9]|3[0-2])){0,1}$/.test(d)}function v(d,E){const l=d.split("."),f=E.split(".");if(l.length<3||f.length<3)return!1;for(let h=0;h<3;h++)if(l[h]!==f[h])return!1;return!0}function I(d){const E=d.split(".");return E[E.length-1]}function S(d){return g(this,null,function*(){const E=`https://cloudflare-dns.com/dns-query?name=${encodeURIComponent(d)}&type=A`,l={Accept:"application/dns-json"};try{const f=yield s.http.get({url:E,headers:l}),h=JSON.parse(f.body);if(h.Status!==0)throw new Error(`HTTP error! status: ${h.Status}`);return h.Answer?h.Answer.map(w=>`${w.data}`)[0]:""}catch(f){return""}})}function T(d){return g(this,null,function*(){return yield s.http.get(`https://dns.google/resolve?name=${d}`).then(l=>{const f=JSON.parse(l.body);if(f.Status===0){const h=f.Answer.find(w=>w.type===1);return h?h.data:""}return""})})}function C(d){return g(this,null,function*(){return yield s.http.get(`http://ip-api.com/json/${d}?fields=country`).then(l=>JSON.parse(l.body).country||"")})}function u(d){return g(this,null,function*(){return yield s.http.get(`http://ip-api.com/json/${d}?fields=region,regionName`).then(l=>{const f=JSON.parse(l.body);return f.regionName&&f.region?`${f.regionName} (${f.region})`:""})})}function P(d){return g(this,null,function*(){return yield s.http.get(`http://ip-api.com/json/${d}?fields=isp`).then(l=>JSON.parse(l.body).isp||"")})}function k(d){return g(this,null,function*(){return yield s.http.post({url:"http://ip-api.com/batch?fields=isp",body:JSON.stringify(d)}).then(l=>JSON.parse(l.body).map(h=>h.isp))})}function U(d,E){let l,f;const h=G(d);if((l=E.match(/^(.*?)\/(\d{1,2})$/))&&(f=G(l[1]))>=0){const w=m(2,32-parseInt(l[2]));return h>=f&&h<=f+w-1}return!1}function G(d){let E;if(E=d.match(/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/)){let l=0,f=1;for(let h=4;h>=1;h-=1)l+=f*parseInt(E[h]),f*=256;return l}return-1}},9085:(_,p,o)=>{o.d(p,{G:()=>m});function m(s){return s&&s!=="null"&&s!=="undefined"}function g(s,O){return s.reduce((t,i)=>{const a=i[O];return t[a]||(t[a]=[]),t[a].push(i),t},{})}},4173:(_,p,o)=>{o.d(p,{$S:()=>E,Ck:()=>U,Hd:()=>d,We:()=>P,eD:()=>G,um:()=>l,xG:()=>k});var m=o(9085),g=o(1058),s=o(1500),O=o(8475),t=Math.pow,i=(e,n,c)=>new Promise((r,y)=>{var L=N=>{try{b(c.next(N))}catch(D){y(D)}},M=N=>{try{b(c.throw(N))}catch(D){y(D)}},b=N=>N.done?r(N.value):Promise.resolve(N.value).then(L,M);b((c=c.apply(e,n)).next())});const a="#sub-store-cached-dns",v="#sub-store-cached-isp",I="#sub-store-cached-region",S=7*24*60*60*1e3,T=new O.A(a,S),C=new O.A(v,S),u=new O.A(I,S);function P(e,n){(e.type==="vmess"||e.type==="vless"||e.type==="trojan")&&(e.network==="ws"&&(e["ws-opts"]=e["ws-opts"]||{},e["ws-opts"].headers=e["ws-opts"].headers||{},e["ws-opts"].headers.Host=n),e.network==="grpc"&&(e["grpc-opts"]=e["grpc-opts"]||{},e["grpc-opts"]["grpc-service-name"]=e["grpc-opts"]["grpc-service-name"]||"",e.servername=n),e.network==="tcp"&&(e.servername=n),e.sni=n),(0,m.G)(e["skip-cert-verify"])||(e["skip-cert-verify"]=!0)}function k(e,n){return(0,g.r)(e.regex).test(n.name)}function U(e,n){return e.ports.some(c=>c===n.port)}function G(e,n){return i(this,null,function*(){return(yield Promise.all(e.ips.map(r=>w(n.server,r)))).some(r=>r)})}function d(e,n){return i(this,null,function*(){return(yield Promise.all(e.isps.map(r=>h(n.server,r)))).some(r=>r)})}function E(e,n){return i(this,null,function*(){return(yield Promise.all(e.regions.map(r=>f(n.server,r)))).some(r=>r)})}function l(e,n,c){return i(this,null,function*(){return(yield Promise.all(e.map(y=>y(n,c)))).every(y=>y)})}function f(e,n){return i(this,null,function*(){const c=yield V(e);try{let r="";const y=u.get(c);y?r=y:(r=yield(0,s.sY)(c),r&&u.set(c,r));const L=(0,g.Z)(r);if(L){const{name:M,code:b}=L,N=s.Zg[n.toLowerCase()];if((0,m.G)(N)&&(N.some(D=>RegExp(`${D}`,"i").test(b))||N.some(D=>RegExp(`${D}`,"i").test(M))))return!0}}catch(r){return!1}return!1})}function h(e,n){return i(this,null,function*(){const c=yield V(e);let r="";const y=C.get(c);return y?r=y:(r=yield(0,s.u6)(c),r&&C.set(c,r)),!!s.Dq[n].some(M=>RegExp(`${M}`,"i").test(r))})}function w(e,n){return i(this,null,function*(){const c=yield V(e);if(!(0,s.qu)(c))return!1;if(n.indexOf("/")<0)return!!(c===n||(0,s.Vo)(c,n)&&(0,s.Mi)(n)==="*");let r,y;const L=R(c);if((r=n.match(/^(.*?)\/(\d{1,2})$/))&&(y=R(r[1]))>=0){const M=t(2,32-parseInt(r[2]));return L>=y&&L<=y+M-1}return!1})}function V(e){return i(this,null,function*(){let n=e;if((0,s.l0)(e)){const c=T.get(e);if(c)n=c;else{const r=yield(0,s.S9)(e);n=r,r&&T.set(e,r)}}return n})}function R(e){let n;if(n=e.match(/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/)){let c=0,r=1;for(let y=4;y>=1;y-=1)c+=r*parseInt(n[y]),r*=256;return c}return-1}},1058:(_,p,o)=>{o.d(p,{Z:()=>g,r:()=>m});function m(s){const O=s.lastIndexOf("/");return new RegExp(s.slice(1,O),s.slice(O+1))}function g(s){const O=/^([^\(]+) \(([^)]+)\)$/,t=s.match(O);return t?{name:t[1].trim(),code:t[2]}:null}}},$={};function A(_){var p=$[_];if(p!==void 0)return p.exports;var o=$[_]={exports:{}};return Y[_](o,o.exports,A),o.exports}A.n=_=>{var p=_&&_.__esModule?()=>_.default:()=>_;return A.d(p,{a:p}),p},A.d=(_,p)=>{for(var o in p)A.o(p,o)&&!A.o(_,o)&&Object.defineProperty(_,o,{enumerable:!0,get:p[o]})},A.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch(_){if(typeof window=="object")return window}}(),A.o=(_,p)=>Object.prototype.hasOwnProperty.call(_,p);var H={};(()=>{var _=A(3183),p=A.n(_),o=A(9085),m=A(423),g=A(4173),s=(t,i,a)=>new Promise((v,I)=>{var S=u=>{try{C(a.next(u))}catch(P){I(P)}},T=u=>{try{C(a.throw(u))}catch(P){I(P)}},C=u=>u.done?v(u.value):Promise.resolve(u.value).then(S,T);C((a=a.apply(t,i)).next())});function O(t,i,a){return s(this,null,function*(){const v=yield(0,m.ru)();for(const I of t){let S="";for(const T in v){const C=v[T];if((0,o.G)(C)){if(T==="default"){S=C.sni;continue}if((0,o.G)(C.sni)&&(!(0,o.G)(C.skip)||!C.skip)){const u=[];if((0,o.G)(C.regex)&&u.push(g.xG),(0,o.G)(C.ports)&&u.push(g.Ck),(0,o.G)(C.ips)&&u.push(g.eD),(0,o.G)(C.isps)&&u.push(g.Hd),(0,o.G)(C.regions)&&u.push(g.$S),(yield(0,g.um)(u,C,I))||u.length===0){S=C.sni;break}}}}(0,g.We)(I,S)}return t})}p().operator=O})()})();})();
